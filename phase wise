# MuseAIka - 3 Phase Development Plan ğŸµ

## Phase 1: Core Emotion Detection & Music Recommendation (MVP)
**Timeline: Weeks 1-3**

### Features
- âœ… User authentication (register/login)
- âœ… Image upload for emotion detection
- âœ… Text-based mood input
- âœ… Manual mood selection
- âœ… Basic music recommendations from Audius
- âœ… Simple player interface
- âœ… Mood history tracking

### Tech Stack
**Frontend:**
- React 18 + Vite
- React Router v6
- Material-UI (MUI)
- Axios
- React Context for state

**Backend:**
- Flask + Flask-CORS
- MongoDB (PyMongo)
- JWT authentication
- Hugging Face Transformers (emotion detection)
- OpenCV (face detection)
- Audius API client

### File Structure Phase 1
```
phase1/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ app.py                    # Main Flask app
â”‚   â”‚   â”œâ”€â”€ config.py                 # Config class
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ user.py              # User model
â”‚   â”‚   â”‚   â””â”€â”€ mood_entry.py        # MoodEntry model
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.py              # Auth routes
â”‚   â”‚   â”‚   â”œâ”€â”€ emotion.py           # Emotion analysis routes
â”‚   â”‚   â”‚   â””â”€â”€ music.py             # Music routes
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ emotion_service.py   # ML emotion detection
â”‚   â”‚   â”‚   â”œâ”€â”€ audius_service.py    # Audius API client
â”‚   â”‚   â”‚   â””â”€â”€ recommender.py       # Basic recommendation logic
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ auth_middleware.py   # JWT verification
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ db.py                # MongoDB connection
â”‚   â”‚       â””â”€â”€ helpers.py           # Helper functions
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ .env.example
â”‚   â””â”€â”€ run.py
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.jsx
â”‚   â”‚   â”œâ”€â”€ App.jsx
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Home.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Login.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Register.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MoodCheck.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Recommendations.jsx
â”‚   â”‚   â”‚   â””â”€â”€ History.jsx
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ Navbar.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MoodSelector.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ EmotionUploader.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ TextMoodAnalyzer.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MusicPlayer.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ TrackCard.jsx
â”‚   â”‚   â”‚   â””â”€â”€ ProtectedRoute.jsx
â”‚   â”‚   â”œâ”€â”€ context/
â”‚   â”‚   â”‚   â””â”€â”€ AuthContext.jsx
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â””â”€â”€ api.js
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â””â”€â”€ constants.js
â”‚   â”‚   â””â”€â”€ styles/
â”‚   â”‚       â””â”€â”€ theme.js
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ vite.config.js
â”‚   â””â”€â”€ index.html
â”‚
â””â”€â”€ docker-compose.phase1.yml
```

---

## Phase 2: Real-time Features & Advanced Recommendations
**Timeline: Weeks 4-6**

### New Features
- âœ… Live webcam emotion tracking (WebSocket)
- âœ… Real-time mood visualization
- âœ… Hybrid recommender system (collaborative + content-based)
- âœ… User feedback on recommendations
- âœ… Last.fm metadata enrichment
- âœ… Playlist creation and management
- âœ… Redis caching layer

### Additional Tech
**Frontend:**
- Socket.IO client
- Chart.js for mood graphs
- IndexedDB for offline support

**Backend:**
- Flask-SocketIO
- Redis for caching
- Last.fm API
- Improved recommendation algorithm

### New Files Phase 2
```
phase2/ (extends phase1)
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ sockets/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ mood_socket.py       # WebSocket handlers
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ lastfm_service.py    # Last.fm API
â”‚   â”‚   â”‚   â”œâ”€â”€ cache_service.py     # Redis caching
â”‚   â”‚   â”‚   â””â”€â”€ hybrid_recommender.py # Advanced recommendations
â”‚   â”‚   â””â”€â”€ models/
â”‚   â”‚       â””â”€â”€ playlist.py          # Playlist model
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ LiveMood.jsx         # Real-time tracking
â”‚   â”‚   â”‚   â”œâ”€â”€ Library.jsx          # User library
â”‚   â”‚   â”‚   â””â”€â”€ PlaylistDetail.jsx
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ WebcamMoodTracker.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MoodChart.jsx
â”‚   â”‚   â”‚   â””â”€â”€ PlaylistEditor.jsx
â”‚   â”‚   â””â”€â”€ hooks/
â”‚   â”‚       â”œâ”€â”€ useSocket.js
â”‚   â”‚       â””â”€â”€ useWebcam.js
â”‚
â””â”€â”€ docker-compose.phase2.yml (adds Redis)
```

---

## Phase 3: AI Music Generation & Collaboration
**Timeline: Weeks 7-10**

### New Features
- âœ… AI music generation (Magenta/TensorFlow)
- âœ… Collaborative playlists (multi-user editing)
- âœ… Mistral AI chatbot for music discovery
- âœ… Advanced mood analytics
- âœ… Social sharing features
- âœ… Export playlists
- âœ… Celery for async tasks

### Additional Tech
**Backend:**
- Celery + Redis (task queue)
- TensorFlow/Magenta
- Mistral AI API
- AWS S3 for generated music storage

**Frontend:**
- WebRTC for collaboration
- Advanced audio visualizations
- PWA features

### New Files Phase 3
```
phase3/ (extends phase2)
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ tasks/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ celery_app.py        # Celery config
â”‚   â”‚   â”‚   â””â”€â”€ generation_tasks.py  # Async generation
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ music_generator.py   # Magenta wrapper
â”‚   â”‚   â”‚   â”œâ”€â”€ mistral_service.py   # AI chat
â”‚   â”‚   â”‚   â””â”€â”€ storage_service.py   # S3 uploads
â”‚   â”‚   â”œâ”€â”€ sockets/
â”‚   â”‚   â”‚   â””â”€â”€ collab_socket.py     # Collaborative editing
â”‚   â”‚   â””â”€â”€ models/
â”‚   â”‚       â”œâ”€â”€ generated_track.py
â”‚   â”‚       â””â”€â”€ conversation.py
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Generator.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CollabPlaylist.jsx
â”‚   â”‚   â”‚   â””â”€â”€ Analytics.jsx
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ MusicGeneratorForm.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ GenerationProgress.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AIChatbot.jsx
â”‚   â”‚   â”‚   â””â”€â”€ MoodAnalytics.jsx
â”‚   â”‚   â””â”€â”€ workers/
â”‚   â”‚       â””â”€â”€ audio.worker.js
â”‚
â””â”€â”€ docker-compose.phase3.yml (adds Celery worker)
```

---

## Development Guidelines

### To Prevent Import Issues:

1. **Use Absolute Imports Everywhere**
   ```python
   # âœ… GOOD
   from src.models.user import User
   from src.services.emotion_service import EmotionService
   
   # âŒ BAD
   from models.user import User
   from ..services.emotion_service import EmotionService
   ```

2. **Always Include `__init__.py`**
   - Every directory with Python files needs `__init__.py`
   - Import key classes in `__init__.py` for easier access

3. **Circular Import Prevention**
   - Put shared types/interfaces in separate files
   - Use lazy imports where necessary
   - Keep models pure (no service imports)

4. **Frontend Import Rules**
   ```javascript
   // âœ… GOOD - Absolute from src
   import api from '@/services/api';
   import { AuthContext } from '@/context/AuthContext';
   
   // Configure vite.config.js with alias
   resolve: {
     alias: { '@': '/src' }
   }
   ```

5. **Database Connection Pattern**
   ```python
   # Single db.py file
   from pymongo import MongoClient
   
   client = None
   db = None
   
   def init_db(app):
       global client, db
       client = MongoClient(app.config['MONGODB_URI'])
       db = client.get_database()
       return db
   
   def get_db():
       return db
   ```

6. **Service Layer Pattern**
   - Services should be stateless classes or modules
   - No circular dependencies between services
   - Config passed at initialization

---

## Environment Setup Order

### Phase 1:
```bash
# 1. Start MongoDB
docker run -d -p 27017:27017 mongo:latest

# 2. Backend setup
cd backend
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python run.py

# 3. Frontend setup
cd frontend
npm install
npm run dev
```

### Phase 2 (adds Redis):
```bash
docker-compose -f docker-compose.phase2.yml up -d
```

### Phase 3 (adds Celery):
```bash
docker-compose -f docker-compose.phase3.yml up -d
```

---

## Testing Strategy

### Phase 1:
- Manual testing of auth flow
- Test emotion detection with sample images
- Verify Audius API integration

### Phase 2:
- WebSocket connection testing
- Load testing for real-time features
- Cache hit rate monitoring

### Phase 3:
- Generation task success rate
- Audio quality validation
- Collaborative editing stress tests

---

## Deployment Strategy

- **Phase 1**: Deploy to Heroku/Railway (simple)
- **Phase 2**: Move to VPS with Docker Compose
- **Phase 3**: Full Kubernetes deployment

---

## Next Steps

I'll now provide complete, working code for **Phase 1** with:
1. Full backend implementation
2. Full frontend implementation
3. Proper import structure
4. Configuration files
5. Setup instructions

Ready to generate Phase 1 code?